<local:ApplicationSubPage
    x:Class="Reloaded.Mod.Launcher.Pages.Alt.BaseSubpages.ApplicationSubPages.AppSummaryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cc="clr-namespace:Reloaded.Mod.Launcher.Controls"
    xmlns:controls="clr-namespace:Reloaded.WPF.Controls;assembly=Reloaded.WPF"
    xmlns:converters="clr-namespace:Reloaded.Mod.Launcher.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dd="urn:gong-wpf-dragdrop"
    xmlns:fa="http://schemas.awesome.incremented/wpf/xaml/fontawesome.sharp"
    xmlns:local="clr-namespace:Reloaded.Mod.Launcher.Pages.BaseSubpages.ApplicationSubPages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:mods="clr-namespace:Reloaded.Mod.Launcher.Controls.Mods"
    xmlns:properties="clr-namespace:Reloaded.Mod.Launcher.Controls.Properties"
    xmlns:system="clr-namespace:System;assembly=mscorlib"
    Title="{DynamicResource TitleConfigureMods}"
    d:DesignHeight="540"
    d:DesignWidth="960"
    mc:Ignorable="d">

    <Grid x:Name="Contents" DataContext="{Binding ViewModel, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Page}}}">

        <!--  Resources  -->
        <Grid.Resources>

            <!--  Filtered Mod List  -->
            <CollectionViewSource
                x:Key="FilteredMods"
                IsLiveFilteringRequested="True"
                Source="{Binding AllMods, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <!--  Filtering setup in code behind.  -->
            </CollectionViewSource>

        </Grid.Resources>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="8" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>

        <!--  Items  -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <Grid Margin="0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>

                <TextBox
                    x:Name="ModsFilter"
                    VerticalAlignment="Bottom"
                    AutomationProperties.Name="{DynamicResource ModManagerSearchMods}"
                    Style="{DynamicResource TextboxWithPlaceholder}"
                    Tag="{DynamicResource ModManagerSearchMods}"
                    TextChanged="ModsFilter_TextChanged" />

                <cc:DropdownMenuControl
                    Grid.Column="2"
                    Margin="8,0,0,0"
                    Header="Display">
                    <StackPanel>
                        <StackPanel.Resources>
                            <Style BasedOn="{StaticResource DefaultCheckBox}" TargetType="{x:Type CheckBox}">
                                <Setter Property="Margin" Value="0,4" />
                            </Style>
                        </StackPanel.Resources>
                        <CheckBox
                            Content="Compact"
                            IsChecked="{Binding IsCompact}"
                            ToolTip="Mods only show minimal information." />
                        <CheckBox
                            Content="Horizontal List"
                            IsChecked="{Binding IsHorizontal}"
                            ToolTip="Mods list will expand horizontally." />
                    </StackPanel>
                </cc:DropdownMenuControl>
            </Grid>

            <mods:ModsList
                Grid.Row="1"
                IsCompact="{Binding IsCompact}"
                ModsSource="{Binding Source={StaticResource FilteredMods}}"
                PreviewKeyDown="KeyboardControls_KeyDown"
                SelectedMod="{Binding SelectedMod, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <mods:ModsList.Style>
                    <Style TargetType="{x:Type mods:ModsList}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsHorizontal}" Value="True">
                                <Setter Property="Orientation" Value="Horizontal" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </mods:ModsList.Style>
            </mods:ModsList>
        </Grid>

        <mods:ModPanel />
    </Grid>
</local:ApplicationSubPage>
